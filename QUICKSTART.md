# Workers Service - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

## 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

## 2. –ü–æ–ª—É—á–µ–Ω–∏–µ Telegram API credentials

### –î–ª—è —á—Ç–µ–Ω–∏—è —á–∞—Ç–æ–≤ (Pyrogram):

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://my.telegram.org
2. –í–æ–π–¥–∏—Ç–µ —Å –≤–∞—à–∏–º –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "API development tools"
4. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `api_id` –∏ `api_hash`

### –î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (Bot API):

1. –ù–∞–ø–∏—à–∏—Ç–µ @BotFather –≤ Telegram
2. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ –∫–æ–º–∞–Ω–¥–æ–π `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ (—Ñ–æ—Ä–º–∞—Ç: `1234567890:ABCdefGHIjklMNOpqrsTUVwxyz`)
5. –ü–æ–ª—É—á–∏—Ç–µ —Å–≤–æ–π chat_id:
   - –ù–∞–ø–∏—à–∏—Ç–µ –±–æ—Ç—É @userinfobot
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–∞—à User ID

## 3. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞

```bash
python api.py
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞:

```bash
./start.sh
```

–°–µ—Ä–≤–∏—Å –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ –ø–æ—Ä—Ç—É **8002**.

## 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
- Swagger UI: http://localhost:8002/docs
- ReDoc: http://localhost:8002/redoc
- Root endpoint: http://localhost:8002/

## 5. –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞

### –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

```bash
curl -X POST http://localhost:8002/workers/start \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": 338908929,
    "mode": "worker",
    "chats": ["@pvz_workers_moscow"],
    "filters": {
      "date_from": "2026-02-10",
      "date_to": "2026-02-20",
      "min_price": 2000,
      "max_price": 5000,
      "shk_filter": "–ª—é–±–æ–µ"
    },
    "api_id": YOUR_API_ID,
    "api_hash": "YOUR_API_HASH",
    "notification_bot_token": "YOUR_BOT_TOKEN",
    "notification_chat_id": YOUR_CHAT_ID,
    "parse_history_days": 14
  }'
```

**–ó–∞–º–µ–Ω–∏—Ç–µ:**
- `YOUR_API_ID` - –Ω–∞ –≤–∞—à Telegram API ID
- `YOUR_API_HASH` - –Ω–∞ –≤–∞—à Telegram API Hash
- `YOUR_BOT_TOKEN` - –Ω–∞ —Ç–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
- `YOUR_CHAT_ID` - –Ω–∞ –≤–∞—à Telegram User ID

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```bash
curl http://localhost:8002/workers/status/{task_id}
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

```bash
curl -X POST http://localhost:8002/workers/stop/{task_id}
```

## 6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:

```bash
python test_api.py
```

**–í–Ω–∏–º–∞–Ω–∏–µ:** API –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º!

## 7. –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

### Mode: "worker" (–ø–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤)

–ò—â–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ª—é–¥–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∏—â—É—Ç —Ä–∞–±–æ—Ç—É –Ω–∞ –ü–í–ó:
- "–ì–æ—Ç–æ–≤ –≤—ã–π—Ç–∏ —Å–µ–≥–æ–¥–Ω—è, —Ü–µ–Ω–∞ 3000"
- "–í—ã–π–¥—É –Ω–∞ –∑–∞–º–µ–Ω—É, –∑–∞–≤—Ç—Ä–∞, 2500 —Ä—É–±"
- "–ú–æ–≥—É 15 —Ñ–µ–≤—Ä–∞–ª—è, 2800"

### Mode: "employer" (–ø–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª–µ–π)

–ò—â–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∏—â—É—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤:
- "–ò—â—É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–∞ –∑–∞–º–µ–Ω—É, –ú—ã—Ç–∏—â–∏, 20 —Ñ–µ–≤—Ä–∞–ª—è, 2800"
- "–ù—É–∂–µ–Ω —Ä–∞–±–æ—Ç–Ω–∏–∫ –≤ –ü–í–ó, –∑–∞–≤—Ç—Ä–∞, –æ–ø–ª–∞—Ç–∞ 3000"

## 8. –§–∏–ª—å—Ç—Ä—ã

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã:
- `date_from`, `date_to` - –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç —Ä–∞–±–æ—Ç—ã (ISO format: "2026-02-10")
- `min_price`, `max_price` - –¥–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω –≤ —Ä—É–±–ª—è—Ö –∑–∞ —Å–º–µ–Ω—É

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä:
- `shk_filter`:
  - `"–ª—é–±–æ–µ"` - –Ω–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –®–ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
  - –ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ - –Ω–∞–ø—Ä–∏–º–µ—Ä, `"100"`
  - –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ - `"–º–∞–ª–æ"`, `"–º–Ω–æ–≥–æ"`, `"—Å—Ä–µ–¥–Ω–µ"`

## 9. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç –≤ –≤–∞—à Telegram –±–æ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ:

```
üë∑ –ù–æ–≤—ã–π —Ä–∞–±–æ—Ç–Ω–∏–∫!

üìÖ –î–∞—Ç–∞: 15 —Ñ–µ–≤—Ä–∞–ª—è 2026
üí∞ –¶–µ–Ω–∞: 3000 —Ä—É–±/—Å–º–µ–Ω—É
üì¶ –®–ö: 100
üìç –õ–æ–∫–∞—Ü–∏—è: –ú—ã—Ç–∏—â–∏
üë§ @ivan_petrov (–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤)
üí¨ –ß–∞—Ç: @pvz_workers_moscow
üîó https://t.me/pvz_workers_moscow/12345

üìù –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç:
"–ì–æ—Ç–æ–≤ –≤—ã–π—Ç–∏ 15 —Ñ–µ–≤—Ä–∞–ª—è, —Ü–µ–Ω–∞ 3000, —à–∫ 100, –ú—ã—Ç–∏—â–∏"

[–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –≤ –ß–°] [–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å]
```

## 10. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ SQLite: `workers.db`

## 11. –õ–æ–≥–∏

–õ–æ–≥–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤:
- –ö–æ–Ω—Å–æ–ª—å (stdout)
- –§–∞–π–ª `workers_service.log` (—Ä–æ—Ç–∞—Ü–∏—è –ø—Ä–∏ 10 MB)

## 12. –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ (–≤–∞–∂–Ω–æ!)

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ Pyrogram –ø–æ–ø—Ä–æ—Å–∏—Ç –≤–∞—Å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ Telegram:

1. –í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
2. –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–∑ Telegram
3. –í–≤–µ–¥–∏—Ç–µ 2FA –ø–∞—Ä–æ–ª—å (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω)

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞—Å—Ç—Å—è session —Ñ–∞–π–ª (`*.session`), –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –±–æ–ª—å—à–µ –Ω–µ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è.

## 13. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
python verify_setup.py
```

–û–Ω –ø—Ä–æ–≤–µ—Ä–∏—Ç –≤—Å–µ —Ñ–∞–π–ª—ã, –∏–º–ø–æ—Ä—Ç—ã –∏ regex –ø–∞—Ç—Ç–µ—Ä–Ω—ã.

## –ì–æ—Ç–æ–≤–æ! üéâ

–°–µ—Ä–≤–∏—Å –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ. –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ —Å Telegram –±–æ—Ç–æ–º (ParserHub), –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –ø–æ–∑–∂–µ.
